<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>VIMuRe - 📚 Python package documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../latest/people.html" rel="next">
<link href="../../latest/pkg-docs.html" rel="prev">
<link href="../../figures/stable_diffusion_stickmen.png" rel="icon" type="image/png">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-N0GX9ECYYQ"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-N0GX9ECYYQ', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  });
});
</script> 
  


<meta name="twitter:title" content="VIMuRe - 📚 Python package documentation">
<meta name="twitter:description" content="VIMuRe v0.1.0-dev-92c8d6b (latest)">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">📚 Python package documentation</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">VIMuRe</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="" title="" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/latentnetworks/vimure">
          Source Code
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/latentnetworks/vimure/discussions">
          Ask Questions
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/latentnetworks/vimure/issues/new/choose">
          Report a Bug
          </a>
        </li>
    </ul>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">🏠 Home</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../latest/install.html" class="sidebar-item-text sidebar-link">📦 Installation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../latest/tutorials.html" class="sidebar-item-text sidebar-link">💻 Tutorials</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../latest/pkg-docs.html" class="sidebar-item-text sidebar-link">📚 Documentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../latest/pkg-docs/python.html" class="sidebar-item-text sidebar-link active">🐍 Python</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../latest/people.html" class="sidebar-item-text sidebar-link">📟 Contact</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#module-vimure.model" id="toc-module-vimure.model" class="nav-link active" data-scroll-target="#module-vimure.model">Module <code>vimure.model</code></a>
  <ul class="collapse">
  <li><a href="#classes" id="toc-classes" class="nav-link" data-scroll-target="#classes">Classes</a>
  <ul class="collapse">
  <li><a href="#vimuremodel" id="toc-vimuremodel" class="nav-link" data-scroll-target="#vimuremodel">VimureModel</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#module-vimure.synthetic" id="toc-module-vimure.synthetic" class="nav-link" data-scroll-target="#module-vimure.synthetic">Module <code>vimure.synthetic</code></a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#classes-1" id="toc-classes-1" class="nav-link" data-scroll-target="#classes-1">Classes</a>
  <ul class="collapse">
  <li><a href="#basesyntheticnetwork" id="toc-basesyntheticnetwork" class="nav-link" data-scroll-target="#basesyntheticnetwork">BaseSyntheticNetwork</a></li>
  <li><a href="#degreecorrectedsbm" id="toc-degreecorrectedsbm" class="nav-link" data-scroll-target="#degreecorrectedsbm">DegreeCorrectedSBM</a></li>
  <li><a href="#hollandlaskeyleinhardtmodel" id="toc-hollandlaskeyleinhardtmodel" class="nav-link" data-scroll-target="#hollandlaskeyleinhardtmodel">HollandLaskeyLeinhardtModel</a></li>
  <li><a href="#multitensor" id="toc-multitensor" class="nav-link" data-scroll-target="#multitensor">Multitensor</a></li>
  <li><a href="#standardsbm" id="toc-standardsbm" class="nav-link" data-scroll-target="#standardsbm">StandardSBM</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#module-vimure.utils" id="toc-module-vimure.utils" class="nav-link" data-scroll-target="#module-vimure.utils">Module <code>vimure.utils</code></a>
  <ul class="collapse">
  <li><a href="#functions-1" id="toc-functions-1" class="nav-link" data-scroll-target="#functions-1">Functions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">📚 Python package documentation</h1>
<p class="subtitle lead">VIMuRe v0.1.0-dev-92c8d6b (latest)</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<details>
<summary>
Module <code>vimure.model</code>
</summary>
<section id="module-vimure.model" class="level1">
<h1>Module <code>vimure.model</code></h1>
<p>Inference model</p>
<section id="classes" class="level2">
<h2 class="anchored" data-anchor-id="classes">Classes</h2>
<section id="vimuremodel" class="level3">
<h3 class="anchored" data-anchor-id="vimuremodel">VimureModel</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> VimureModel(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    undirected:&nbsp;bool&nbsp;<span class="op">=</span>&nbsp;False,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    mutuality:&nbsp;bool&nbsp;<span class="op">=</span>&nbsp;True,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    convergence_tol:&nbsp;float&nbsp;<span class="op">=</span>&nbsp;<span class="fl">0.1</span>,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    decision:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">1</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    verbose:&nbsp;bool&nbsp;<span class="op">=</span>&nbsp;False</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>ViMuRe</strong></p>
<p>Fit a probabilistic generative model to double sampled networks. It returns reliability parameters for the reporters (theta), average interactions for the links (lambda) and the estimate of the true and unknown network (rho). The inference is performed with a Variational Inference approach.</p>
<p>📝 note: this closely follows the <a href="https://github.com/scikit-learn-contrib/project-template/blob/master/skltemplate/_template.py">scikit-learn structure of classes</a></p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>undirected</code></strong> : <code>boolean</code></p>
<p>Whether the network is undirected.</p></li>
<li><p><strong><code>mutuality</code></strong> : <code>boolean</code></p>
<p>Whether to use the mutuality parameter.</p></li>
<li><p><strong><code>convergence_tol</code></strong> : <code>float</code></p>
<p>Controls when to stop the optimisation algorithm (CAVI)</p></li>
</ul>
<section id="ancestors" class="level4">
<h4 class="anchored" data-anchor-id="ancestors">Ancestors</h4>
<ul>
<li>sklearn.base.TransformerMixin</li>
<li>sklearn.utils._set_output._SetOutputMixin</li>
<li>sklearn.base.BaseEstimator</li>
</ul>
</section>
<section id="methods" class="level4">
<h4 class="anchored" data-anchor-id="methods">Methods</h4>
</section>
<section id="fit" class="level4">
<h4 class="anchored" data-anchor-id="fit"><code>fit</code></h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fit(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    X,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    theta_prior<span class="op">=</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    lambda_prior<span class="op">=</span>(<span class="fl">10.0</span>, <span class="fl">10.0</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    eta_prior<span class="op">=</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    rho_prior<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    seed:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;None,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>extra_params</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>X</code></strong> : <code>ndarray</code></p>
<p>Network adjacency tensor.</p></li>
<li><p><strong><code>theta_prior</code></strong> : <code>2D tuple</code></p>
<p>Shape and scale hyperparameters for variable theta</p></li>
<li><p><strong><code>lambda_prior</code></strong> : <code>2D tuple</code></p>
<p>Shape and scale hyperparameters for variable lambda</p></li>
<li><p><strong><code>eta_prior</code></strong> : <code>2D tuple</code></p>
<p>Shape and scale hyperparameters for variable eta</p></li>
<li><p><strong><code>rho_prior</code></strong> : <code>None/ndarray</code></p>
<p>Array with prior values of the rho parameter - if ndarray.</p></li>
<li><p><strong><code>R</code></strong> : <code>ndarray (optional)</code></p>
<p>a multidimensional array L x N x N x M indicating which reports to consider</p></li>
<li><p><strong><code>K</code></strong> : <code>None/int (optional)</code></p>
<p>Value of the maximum entry of the network - i</p></li>
<li><p><strong><code>EPS</code></strong> : <code>float (optional)</code></p>
<p>White noise. Default: 1e-12</p></li>
<li><p><strong><code>bias0</code></strong> : <code>float (optional)</code></p>
<p>Bias for rho_prior entry 0. Default: 0.2</p></li>
<li><p><strong><code>max_iter</code></strong> : <code>int (optional)</code></p>
<p>Maximum number of iteration steps before aborting. Default=500</p></li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p><strong><code>self</code></strong> : <code>object</code></p>
<p>Returns the instance itself.</p></li>
</ul>
</section>
<section id="get_inferred_model" class="level4">
<h4 class="anchored" data-anchor-id="get_inferred_model"><code>get_inferred_model</code></h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_inferred_model(<span class="va">self</span>, method<span class="op">=</span><span class="st">'rho_max'</span>, threshold<span class="op">=</span><span class="va">None</span>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Estimate Y</p>
<p>Use this function to reconstruct the Y matrix with a fitted vimure model. It will use <code>model.rho_f</code> values to extract an estimated Y matrix.</p>
<ul>
<li><em>rho_max</em>: Assign the value of the highest probability</li>
<li><em>rho_mean</em>: Expected value of the discrete distribution</li>
<li><em>fixed_threshold</em>: Check if the probability is higher than a threshold (Only for K=2)</li>
<li><em>heuristic_threshold</em>: Calculate and use the best threshold (Only for K=2)</li>
</ul>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>model</code></strong> : <code>vm.model.VimureModel</code></p>
<p>A <code>vm.model.VimureModel</code> object</p></li>
<li><p><strong><code>method</code></strong> : <code>str</code></p>
<p>A character string indicating which method is to be computed.</p></li>
</ul>
<p>One of “rho_max” (default), “rho_mean”, “fixed_threshold” or “heuristic_threshold”. - <strong><code>threshold</code></strong> : <code>float</code></p>
<pre><code>A threshold to be used when method = "fixed_threshold".</code></pre>
<p><strong>Returns</strong></p>
<ul>
<li><p><strong><code>Y</code></strong> : <code>ndarray</code></p>
<p>&nbsp;</p></li>
</ul>
</section>
<section id="get_posterior_estimates" class="level4">
<h4 class="anchored" data-anchor-id="get_posterior_estimates"><code>get_posterior_estimates</code></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_posterior_estimates(<span class="va">self</span>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Get posterior estimates</p>
<p>Use this function to get the posterior estimates of the model parameters</p>
<p><strong>Returns</strong></p>
<ul>
<li><p><strong><code>posterior_estimates</code></strong> : <code>dict</code></p>
<p>A dictionary with the posterior estimates of the model parameters (nu, theta, lambda, rho). See 💻 <a href="../../latest/tutorials/python/tutorial02-introduction-to-vimure.html#posterior-estimates">Tutorial 02</a>.</p></li>
</ul>
</section>
<section id="sample_inferred_model" class="level4">
<h4 class="anchored" data-anchor-id="sample_inferred_model"><code>sample_inferred_model</code></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sample_inferred_model(<span class="va">self</span>, N<span class="op">=</span><span class="dv">1</span>, seed<span class="op">=</span><span class="va">None</span>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Sample Y trials from rho distribution</p>
<p>Use this function to sample Y trials with a fitted vimure model. It will use <code>model.rho_f</code> as the probabilities of a discrete distribution.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>model</code></strong> : <code>vm.model.VimureModel</code></p>
<p>A <code>vm.model.VimureModel</code> object</p></li>
<li><p><strong><code>N</code></strong> : <code>int</code></p>
<p>Number of trials</p></li>
<li><p><strong><code>seed</code></strong> : <code>int</code></p>
<p>A pseudo generator seed</p></li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p><strong><code>Y</code></strong> : <code>List[ndarray]</code></p>
<p>A list of trials</p></li>
</ul>
</section></section></section></section></details>
<details>
<summary>
Module <code>vimure.synthetic</code>
</summary>




<section id="module-vimure.synthetic" class="level1">
<h1>Module <code>vimure.synthetic</code></h1>
<p>Code to generate synthetic networks that emulates directed double-sample questions networks</p>
<p>You can read more about our synthetic network generation in our paper: <span class="citation" data-cites="de_bacco_latent_2023">(<a href="#ref-de_bacco_latent_2023" role="doc-biblioref">De Bacco et al. 2023</a>)</span></p>
<section id="functions" class="level2">
<h2 class="anchored" data-anchor-id="functions">Functions</h2>
<section id="build_custom_theta" class="level4">
<h4 class="anchored" data-anchor-id="build_custom_theta"><code>build_custom_theta</code></h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_custom_theta(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    gt_network:&nbsp;BaseSyntheticNetwork,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    theta_ratio:&nbsp;float&nbsp;<span class="op">=</span>&nbsp;<span class="fl">0.5</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    exaggeration_type:&nbsp;str&nbsp;<span class="op">=</span>&nbsp;<span class="st">'over'</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    seed:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;None</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Instead of the regular generative model for <code>theta ~ Gamma(sh,sc)</code>, create a more extreme scenario where some percentage of reporters are exaggerating.</p>
<p><strong>Parameters</strong></p>
<p><strong><code>gt_network</code></strong> : <a href="vimure.#vimure.synthetic.BaseSyntheticNetwork"><code>BaseSyntheticNetwork</code></a> A network generated from a generative model. - <strong><code>theta_ratio</code></strong> : <code>float</code></p>
<pre><code>Percentage of reporters who exaggerate.</code></pre>
<ul>
<li><p><strong><code>exaggeration_type</code></strong> : <code>str</code></p>
<p>(“over”, “under”)</p></li>
<li><p><strong><code>seed</code></strong> : <code>int</code></p>
<p>If not set, use gt_network.prng instead.</p></li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p><strong><code>theta</code></strong> : <code>numpy.array</code></p>
<p>A L x M matrix for theta.</p></li>
</ul>
</section>
<section id="build_self_reporter_mask" class="level4">
<h4 class="anchored" data-anchor-id="build_self_reporter_mask"><code>build_self_reporter_mask</code></h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_self_reporter_mask(gt_network):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Build the reporters’ mask in a way such that:</p>
<ul>
<li>A reporter <code>m</code> can report ties in which she is ego: <code>m --&gt; i</code></li>
<li>A reporter <code>m</code> can report ties in which she is alter: <code>i --&gt; m</code></li>
<li>A reporter <code>m</code> <strong>cannot</strong> report ties she is not involved, that is <code>i --&gt; j</code> where <code>i != m</code> and <code>j != m</code></li>
</ul>
<p><strong>Parameters</strong></p>
<p><strong><code>gt_network</code></strong> : <a href="vimure.#vimure.synthetic.BaseSyntheticNetwork"><code>BaseSyntheticNetwork</code></a> Generative ground truth model.</p>
</section>
</section>
<section id="classes-1" class="level2">
<h2 class="anchored" data-anchor-id="classes-1">Classes</h2>
<section id="basesyntheticnetwork" class="level3">
<h3 class="anchored" data-anchor-id="basesyntheticnetwork">BaseSyntheticNetwork</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BaseSyntheticNetwork(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    N:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">100</span>,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    M:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">100</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    L:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">1</span>,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    K:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">2</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    seed:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">0</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A base abstract class for generation and management of synthetic networks. Suitable for representing any type of synthetic network (whether SBM or not).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>N</code></strong> : <code>int</code></p>
<p>Number of nodes.</p></li>
<li><p><strong><code>M</code></strong> : <code>int</code></p>
<p>Number of reporters.</p></li>
<li><p><strong><code>L</code></strong> : <code>int</code></p>
<p>Number of layers.</p></li>
<li><p><strong><code>K</code></strong> : <code>int</code></p>
<p>Maximum edge weight in the adjacency matrix. When <code>K=2</code>, the adjacency matrix will contain some <code>Y_{ij}=0</code> and <code>Y_{ij}=1</code>.</p></li>
<li><p><strong><code>seed</code></strong> : <code>int</code></p>
<p>Pseudo random generator seed to use.</p></li>
</ul>
<section id="ancestors-1" class="level4">
<h4 class="anchored" data-anchor-id="ancestors-1">Ancestors</h4>
<ul>
<li>vimure._io.BaseNetwork</li>
</ul>
</section>
<section id="subclasses" class="level4">
<h4 class="anchored" data-anchor-id="subclasses">Subclasses</h4>
<ul>
<li><a href="#vimure.synthetic.HollandLaskeyLeinhardtModel" title="vimure.synthetic.HollandLaskeyLeinhardtModel">HollandLaskeyLeinhardtModel</a></li>
<li><a href="#vimure.synthetic.StandardSBM" title="vimure.synthetic.StandardSBM">StandardSBM</a></li>
</ul>
</section>
</section>
<section id="degreecorrectedsbm" class="level3">
<h3 class="anchored" data-anchor-id="degreecorrectedsbm">DegreeCorrectedSBM</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DegreeCorrectedSBM(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    exp_in:&nbsp;float&nbsp;<span class="op">=</span>&nbsp;<span class="dv">2</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    exp_out:&nbsp;float&nbsp;<span class="op">=</span>&nbsp;<span class="fl">2.5</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Degree-corrected stochastic blockmodel.</strong></p>
<p>A generative model that incorporates heterogeneous vertex degrees into stochastic blockmodels, improving the performance of the models for statistical inference of group structure. For more information about this model, see <span class="citation" data-cites="karrer_stochastic_2011">(<a href="#ref-karrer_stochastic_2011" role="doc-biblioref">Karrer and Newman 2011</a>)</span>.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>exp_in</code></strong> : <code>float</code></p>
<p>Exponent power law of in-degree distribution.</p></li>
<li><p><strong><code>exp_out</code></strong> : <code>float</code></p>
<p>Exponent power law of out-degree distribution.</p></li>
<li><p><strong><code>kwargs</code></strong> : <code>dict</code></p>
<p>Additional arguments of <a href="vimure.#vimure.synthetic.StandardSBM"><code>StandardSBM</code></a>.</p></li>
</ul>
<section id="ancestors-2" class="level4">
<h4 class="anchored" data-anchor-id="ancestors-2">Ancestors</h4>
<ul>
<li><a href="#vimure.synthetic.StandardSBM" title="vimure.synthetic.StandardSBM">StandardSBM</a></li>
<li><a href="#vimure.synthetic.BaseSyntheticNetwork" title="vimure.synthetic.BaseSyntheticNetwork">BaseSyntheticNetwork</a></li>
<li>vimure._io.BaseNetwork</li>
</ul>
</section>
</section>
<section id="hollandlaskeyleinhardtmodel" class="level3">
<h3 class="anchored" data-anchor-id="hollandlaskeyleinhardtmodel">HollandLaskeyLeinhardtModel</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> HollandLaskeyLeinhardtModel(<span class="op">**</span>kwargs):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A base abstract class for generation and management of synthetic networks. Suitable for representing any type of synthetic network (whether SBM or not).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>N</code></strong> : <code>int</code></p>
<p>Number of nodes.</p></li>
<li><p><strong><code>M</code></strong> : <code>int</code></p>
<p>Number of reporters.</p></li>
<li><p><strong><code>L</code></strong> : <code>int</code></p>
<p>Number of layers.</p></li>
<li><p><strong><code>K</code></strong> : <code>int</code></p>
<p>Maximum edge weight in the adjacency matrix. When <code>K=2</code>, the adjacency matrix will contain some <code>Y_{ij}=0</code> and <code>Y_{ij}=1</code>.</p></li>
<li><p><strong><code>seed</code></strong> : <code>int</code></p>
<p>Pseudo random generator seed to use.</p></li>
</ul>
<section id="ancestors-3" class="level4">
<h4 class="anchored" data-anchor-id="ancestors-3">Ancestors</h4>
<ul>
<li><a href="#vimure.synthetic.BaseSyntheticNetwork" title="vimure.synthetic.BaseSyntheticNetwork">BaseSyntheticNetwork</a></li>
<li>vimure._io.BaseNetwork</li>
</ul>
</section>
</section>
<section id="multitensor" class="level3">
<h3 class="anchored" data-anchor-id="multitensor">Multitensor</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Multitensor(eta<span class="op">=</span><span class="fl">0.5</span>, ExpM<span class="op">=</span><span class="va">None</span>, <span class="op">**</span>kwargs):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>A generative model with reciprocity</strong></p>
<p>A mathematically principled generative model for capturing both community and reciprocity patterns in directed networks. Adapted from <span class="citation" data-cites="safdari_generative_2021">(<a href="#ref-safdari_generative_2021" role="doc-biblioref">Safdari, Contisciani, and De Bacco 2021</a>)</span>.</p>
<p>Generate a directed, possibly weighted network by using the reciprocity generative model. Can be used to generate benchmarks for networks with reciprocity.</p>
<p><strong>Steps:</strong></p>
<ol type="1">
<li>Generate the latent variables.</li>
<li>Extract <code>A_{ij}</code> entries (network edges) from a Poisson distribution; its mean depends on the latent variables.</li>
</ol>
<p>Note: Open Source code available at <a href="https://github.com/mcontisc/CRep" class="uri">https://github.com/mcontisc/CRep</a> and modified in accordance with its <a href="https://github.com/mcontisc/CRep/blob/master/LICENSE">license</a>.</p>
<hr>
<p>Copyright (c) 2020 Hadiseh Safdari, Martina Contisciani and Caterina De Bacco.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>eta</code></strong> : <code>float</code></p>
<p>Initial value for the reciprocity coefficient. Eta has to be in [0, 1).</p></li>
<li><p><strong><code>ExpM</code></strong> : <code>int</code></p>
<p>Expected number of edges</p></li>
</ul>
<p><strong><code>kwargs</code></strong> Additional arguments of <a href="vimure.#vimure.synthetic.StandardSBM"><code>StandardSBM</code></a></p>
<section id="ancestors-4" class="level4">
<h4 class="anchored" data-anchor-id="ancestors-4">Ancestors</h4>
<ul>
<li><a href="#vimure.synthetic.StandardSBM" title="vimure.synthetic.StandardSBM">StandardSBM</a></li>
<li><a href="#vimure.synthetic.BaseSyntheticNetwork" title="vimure.synthetic.BaseSyntheticNetwork">BaseSyntheticNetwork</a></li>
<li>vimure._io.BaseNetwork</li>
</ul>
</section>
</section>
<section id="standardsbm" class="level3">
<h3 class="anchored" data-anchor-id="standardsbm">StandardSBM</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> StandardSBM(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    C:&nbsp;int&nbsp;<span class="op">=</span>&nbsp;<span class="dv">2</span>,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    structure:&nbsp;str&nbsp;<span class="op">=</span>&nbsp;None,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    avg_degree:&nbsp;float&nbsp;<span class="op">=</span>&nbsp;<span class="dv">2</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    sparsify:&nbsp;bool&nbsp;<span class="op">=</span>&nbsp;True,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    overlapping:&nbsp;float&nbsp;<span class="op">=</span>&nbsp;<span class="fl">0.0</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">**</span>kwargs</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Creates a standard stochastic block-model synthetic network.</strong></p>
<p>A generative graph model which assumes the probability of connecting two nodes in a graph is determined entirely by their block assignments. For more information about this model, see Holland, P. W., Laskey, K. B., &amp; Leinhardt, S. (1983). <em>Stochastic blockmodels: First steps. Social networks</em>, 5(2), 109-137. <a href="https://www.sciencedirect.com/science/article/abs/pii/0378873383900217">DOI:10.1016/0378-8733(83)90021-7</a></p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>C</code></strong> : <code>int</code></p>
<p>Number of communities</p></li>
<li><p><strong><code>structure</code></strong> : <code>str</code></p>
<p>Structures for the affinity tensor <code>w</code>. It can be ‘assortative’ or ‘disassortative’.</p></li>
</ul>
<p>It can be a list to map structure for each layer in a multilayer graph. - <strong><code>avg_degree</code></strong> : <code>float</code></p>
<pre><code>Desired average degree for the network. It is not guaranteed that the</code></pre>
<p>ultimate network will have that exact average degree value. Try tweaking this parameter if you want to increase or decrease the density of the network. - <strong><code>sparsify</code></strong> : <code>bool</code></p>
<pre><code>If True (default), enforce sparsity.</code></pre>
<ul>
<li><p><strong><code>overlapping</code></strong> : <code>float</code></p>
<p>Fraction of nodes with mixed membership. It has to be in [<code>0, 1)</code>.</p></li>
</ul>
<p><strong><code>kwargs</code></strong> Additional arguments of <code>[StandardSBM</code>](vimure.#vimure.synthetic.StandardSBM)</p>
<section id="ancestors-5" class="level4">
<h4 class="anchored" data-anchor-id="ancestors-5">Ancestors</h4>
<ul>
<li><a href="#vimure.synthetic.BaseSyntheticNetwork" title="vimure.synthetic.BaseSyntheticNetwork">BaseSyntheticNetwork</a></li>
<li>vimure._io.BaseNetwork</li>
</ul>
</section>
<section id="subclasses-1" class="level4">
<h4 class="anchored" data-anchor-id="subclasses-1">Subclasses</h4>
<ul>
<li><a href="#vimure.synthetic.DegreeCorrectedSBM" title="vimure.synthetic.DegreeCorrectedSBM">DegreeCorrectedSBM</a></li>
<li><a href="#vimure.synthetic.Multitensor" title="vimure.synthetic.Multitensor">Multitensor</a></li>
</ul>
</section></section></section></section></details>
<details>
<summary>
Module <code>vimure.utils</code>
</summary>




<section id="module-vimure.utils" class="level1">
<h1>Module <code>vimure.utils</code></h1>
<section id="functions-1" class="level2">
<h2 class="anchored" data-anchor-id="functions-1">Functions</h2>
<section id="apply_rho_threshold" class="level4">
<h4 class="anchored" data-anchor-id="apply_rho_threshold"><code>apply_rho_threshold</code></h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> apply_rho_threshold(model, threshold<span class="op">=</span><span class="va">None</span>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Apply a threshold to binarise the rho matrix and return the recovered Y</p>
</section>
<section id="calculate_auc" class="level4">
<h4 class="anchored" data-anchor-id="calculate_auc"><code>calculate_AUC</code></h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_AUC(pred, data0, mask<span class="op">=</span><span class="va">None</span>):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Return the AUC of the link prediction. It represents the probability that a randomly chosen missing connection (true positive) is given a higher score by our method than a randomly chosen pair of unconnected vertices (true negative).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>pred</code></strong> : <code>ndarray</code></p>
<p>Inferred values.</p></li>
<li><p><strong><code>data0</code></strong> : <code>ndarray</code></p>
<p>Given values.</p></li>
<li><p><strong><code>mask</code></strong> : <code>ndarray</code></p>
<p>Mask for selecting a subset of the adjacency tensor.</p></li>
</ul>
<p><strong>Returns</strong></p>
<p>AUC value.</p>
</section>
<section id="calculate_average_over_reporter_mask" class="level4">
<h4 class="anchored" data-anchor-id="calculate_average_over_reporter_mask"><code>calculate_average_over_reporter_mask</code></h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_average_over_reporter_mask(X, R):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="calculate_overall_reciprocity" class="level4">
<h4 class="anchored" data-anchor-id="calculate_overall_reciprocity"><code>calculate_overall_reciprocity</code></h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_overall_reciprocity(Y):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="get_item_array_from_subs" class="level4">
<h4 class="anchored" data-anchor-id="get_item_array_from_subs"><code>get_item_array_from_subs</code></h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_item_array_from_subs(A, ref_subs):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Get values of ref_subs entries of a dense tensor. Output is a 1-d array with dimension = number of non zero entries.</p>
</section>
<section id="get_optimal_threshold" class="level4">
<h4 class="anchored" data-anchor-id="get_optimal_threshold"><code>get_optimal_threshold</code></h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_optimal_threshold(model):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><a href="https://arxiv.org/pdf/2112.11396.pdf" class="uri">https://arxiv.org/pdf/2112.11396.pdf</a> pg 8</p>
</section>
<section id="is_sparse" class="level4">
<h4 class="anchored" data-anchor-id="is_sparse"><code>is_sparse</code></h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_sparse(X):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Check whether the input tensor is sparse. It implements a heuristic definition of sparsity. A tensor is considered sparse if: given M = number of modes S = number of entries I = number of non-zero entries then N &gt; M(I + 1)</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>X</code></strong> : <code>ndarray</code></p>
<p>Input data.</p></li>
</ul>
<p><strong>Returns</strong></p>
<p>Boolean flag: true if the input tensor is sparse, false otherwise.</p>
</section>
<section id="match_arg" class="level4">
<h4 class="anchored" data-anchor-id="match_arg"><code>match_arg</code></h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> match_arg(x, lst):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="preprocess" class="level4">
<h4 class="anchored" data-anchor-id="preprocess"><code>preprocess</code></h4>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess(X):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Pre-process input data tensor. If the input is sparse, returns an int sptensor. Otherwise, returns an int dtensor.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>X</code></strong> : <code>ndarray/list</code></p>
<p>Input data.</p></li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><p><strong><code>X</code></strong> : <code>sptensor/dtensor</code></p>
<p>Pre-processed data. If the input is sparse, returns an int sptensor. Otherwise, returns an int dtensor.</p></li>
</ul>
</section>
<section id="sparse_max" class="level4">
<h4 class="anchored" data-anchor-id="sparse_max"><code>sparse_max</code></h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sparse_max(A, B):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Return the element-wise maximum of sparse matrices <code>A</code> and <code>B</code>.</p>
</section>
<section id="sptensor_from_dense_array" class="level4">
<h4 class="anchored" data-anchor-id="sptensor_from_dense_array"><code>sptensor_from_dense_array</code></h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sptensor_from_dense_array(X):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Create an sptensor from a ndarray or dtensor.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>X</code></strong> : <code>ndarray</code></p>
<p>Input data.</p></li>
</ul>
<p><strong>Returns</strong></p>
<p>sptensor from a ndarray or dtensor.</p>
</section>
<section id="sptensor_from_list" class="level4">
<h4 class="anchored" data-anchor-id="sptensor_from_list"><code>sptensor_from_list</code></h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sptensor_from_list(X):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Create an sptensor a sptensor from a list.</p>
<p>Assuming it is a list of dimensions L x M with sparse matrices as elements</p>
</section>
<section id="transpose_ij" class="level4">
<h4 class="anchored" data-anchor-id="transpose_ij"><code>transpose_ij</code></h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> transpose_ij(M):</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Compute the transpose of a matrix.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><p><strong><code>M</code></strong> : <code>numpy.array</code></p>
<p>Numpy matrix.</p></li>
</ul>
<p><strong>Returns</strong></p>
<p>Transpose of the matrix.</p>
</section></section></section></details>







<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-de_bacco_latent_2023" class="csl-entry" role="doc-biblioentry">
De Bacco, Caterina, Martina Contisciani, Jonathan Cardoso-Silva, Hadiseh Safdari, Gabriela Lima Borges, Diego Baptista, Tracy Sweet, et al. 2023. <span>“Latent Network Models to Account for Noisy, Multiply Reported Social Network Data.”</span> <em>Journal of the Royal Statistical Society Series A: Statistics in Society</em>, February, qnac004. <a href="https://doi.org/10.1093/jrsssa/qnac004">https://doi.org/10.1093/jrsssa/qnac004</a>.
</div>
<div id="ref-karrer_stochastic_2011" class="csl-entry" role="doc-biblioentry">
Karrer, Brian, and M. E. J. Newman. 2011. <span>“Stochastic Blockmodels and Community Structure in Networks.”</span> <em>Physical Review E</em> 83 (1): 016107. <a href="https://doi.org/10.1103/PhysRevE.83.016107">https://doi.org/10.1103/PhysRevE.83.016107</a>.
</div>
<div id="ref-safdari_generative_2021" class="csl-entry" role="doc-biblioentry">
Safdari, Hadiseh, Martina Contisciani, and Caterina De Bacco. 2021. <span>“Generative Model for Reciprocity and Community Detection in Networks.”</span> <em>Physical Review Research</em> 3 (2): 023209. <a href="https://doi.org/10.1103/PhysRevResearch.3.023209">https://doi.org/10.1103/PhysRevResearch.3.023209</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/^(?:http:|https:)\/\/(?:latentnetworks\.github\.io\/|localhost)/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../latest/pkg-docs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">📚 Documentation</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../latest/people.html" class="pagination-link">
        <span class="nav-page-text">📟 Contact</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center"><div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
  </div>
</footer>



</body></html>