<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="This tutorial will show you how to prepare your data for VIMuRe.">

<title>VIMuRe - üíª Tutorial 01: Preparing your data for VIMuRe in python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../figures/stable_diffusion_stickmen.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">üíª <strong>Tutorial 01</strong>: Preparing your data for VIMuRe in python</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">VIMuRe</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="" title="" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-github"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/latentnetworks/vimure">
          Source Code
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/latentnetworks/vimure/discussions">
          Ask Questions
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/latentnetworks/vimure/issues/new/choose">
          Report a Bug
          </a>
        </li>
    </ul>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">üè† Home</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../latest/install.html" class="sidebar-item-text sidebar-link">üì¶ Installation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../latest/tutorials.html" class="sidebar-item-text sidebar-link">üíª Tutorials</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../latest/people.html" class="sidebar-item-text sidebar-link">üìü Contact</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#step-1-download-edgelist" id="toc-step-1-download-edgelist" class="nav-link" data-scroll-target="#step-1-download-edgelist">Step 1: Download edgelist</a></li>
  <li><a href="#step-2-collect-individual-level-metadata" id="toc-step-2-collect-individual-level-metadata" class="nav-link" data-scroll-target="#step-2-collect-individual-level-metadata">Step 2: Collect individual-level metadata</a></li>
  <li><a href="#step-3-build-an-edge-list-per-village" id="toc-step-3-build-an-edge-list-per-village" class="nav-link" data-scroll-target="#step-3-build-an-edge-list-per-village">Step 3: Build an edge list per village</a>
  <ul class="collapse">
  <li><a href="#read-metadata" id="toc-read-metadata" class="nav-link" data-scroll-target="#read-metadata">3.1. Read metadata</a></li>
  <li><a href="#read-village-data" id="toc-read-village-data" class="nav-link" data-scroll-target="#read-village-data">3.2. Read village data</a></li>
  <li><a href="#read-reports-per-relationship-type" id="toc-read-reports-per-relationship-type" class="nav-link" data-scroll-target="#read-reports-per-relationship-type">3.3 Read reports per relationship type</a></li>
  <li><a href="#pre-process-the-data-to-build-the-edge-list" id="toc-pre-process-the-data-to-build-the-edge-list" class="nav-link" data-scroll-target="#pre-process-the-data-to-build-the-edge-list">3.4. Pre-process the data to build the edge list</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">üíª <strong>Tutorial 01</strong>: Preparing your data for VIMuRe in python</h1>
<p class="subtitle lead">VIMuRe v0.1.0 (latest)</p>
  <div class="quarto-categories">
    <div class="quarto-category">basics</div>
    <div class="quarto-category">python</div>
  </div>
  </div>

<div>
  <div class="description">
    This tutorial will show you how to prepare your data for VIMuRe.
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you use <code>VIMuRe</code> in your research, please cite <span class="citation" data-cites="de_bacco_latent_2023">(<a href="#ref-de_bacco_latent_2023" role="doc-biblioref">De Bacco et al. 2023</a>)</span>.</p>
</div>
</div>
<p>TLDR: By the end of this tutorial, you should produce a data frame in the following format:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">respondent</th>
<th style="text-align: right;">i</th>
<th style="text-align: right;">j</th>
<th style="text-align: left;">tie_type</th>
<th style="text-align: right;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100201</td>
<td style="text-align: right;">107603</td>
<td style="text-align: right;">100201</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">100202</td>
<td style="text-align: right;">100201</td>
<td style="text-align: right;">100202</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100601</td>
<td style="text-align: right;">101901</td>
<td style="text-align: right;">100601</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">100601</td>
<td style="text-align: right;">102601</td>
<td style="text-align: right;">100601</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100601</td>
<td style="text-align: right;">115501</td>
<td style="text-align: right;">100601</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">100602</td>
<td style="text-align: right;">100501</td>
<td style="text-align: right;">100602</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Before you start using <code>VIMuRe</code>, you need to prepare your data in a specific format. This tutorial will show you how to do that.</p>
<p>Here, we will illustrate the process of preparing data for the <code>VIMuRe</code> package using the <strong>‚ÄúData on Social Networks and Microfinance in Indian Villages‚Äù</strong> dataset <span class="citation" data-cites="banerjee_diffusion_2013">(<a href="#ref-banerjee_diffusion_2013" role="doc-biblioref">Banerjee et al. 2013b</a>)</span>. This dataset contains network data on 75 villages in the Karnataka state of India.</p>
<p><strong>‚öôÔ∏è Setup</strong></p>
<p>We will rely on the following packages in this tutorial:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="step-1-download-edgelist" class="level1">
<h1>Step 1: Download edgelist</h1>
<p>Follow the steps below to download the data.</p>
<ol type="1">
<li>Click on [https://www.stanford.edu/~jacksonm/IndianVillagesDataFiles.zip) to download the dataset from Prof.&nbsp;<a href="https://web.stanford.edu/~jacksonm/">Matthew O. Jackson‚Äôs website</a> [^1]. This will download a file called <code>IndianVillagesDataFiles.zip</code> in your working directory.</li>
<li>Unzip the file. This will create a folder called <code>2010-0760_Data</code> in your working directory. üí° Tip: you can use the <code>unzip()</code> function from within R to unzip the file.</li>
</ol>
<p>The folder structure should look like this:</p>
<p><img src="../../../figures/tutorials/jackson_download_zipfile.png" class="img-fluid" alt="Screenshot of how folder structure should look like."></p>
<p>The data we need is within that <code>Data/Raw_csv/</code> folder, and looks like this:</p>
<p><img src="../../../figures/tutorials/karnataka_raw_csvs.png" class="img-fluid"></p>
</section>
<section id="step-2-collect-individual-level-metadata" class="level1">
<h1>Step 2: Collect individual-level metadata</h1>
<p>We also need individual-level information metadata. This data is available on a separate source, the Harvard Dataverse <span class="citation" data-cites="banerjee_diffusion_2013-1">(<a href="#ref-banerjee_diffusion_2013-1" role="doc-biblioref">Banerjee et al. 2013a</a>)</span>.</p>
<ol type="1">
<li>Go to <a href="https://dataverse.harvard.edu/file.xhtml?fileId=2460959&amp;version=9.4">https://dataverse.harvard.edu/file.xhtml?fileId=2460959&amp;version=9.4</a>, read and accept the ‚ÄúLicense/Data Use Agreement‚Äù to gain access to the data. We are using version 9.4 of the dataset.</li>
<li>Click on the ‚ÄúAccess File‚Äù button, then ‚ÄúDownload | ZIP Archive‚Äù to download the data.</li>
</ol>
<blockquote class="blockquote">
<p><img src="../../../figures/tutorials/dataverse_harvard_download_zipfile.png" class="img-fluid" alt="Screenshot of how to download data from Harvard Dataverse."></p>
</blockquote>
<ol start="3" type="1">
<li>Unzip the file. This will create a folder called <code>datav4.0.zip</code> in your working directory.</li>
</ol>
<p>The data we need is within that <code>datav4.0/Data/2. Demographics and Outcomes/</code> folder.</p>
<ol start="4" type="1">
<li>Read the data into Python using the <code>pd.read_stata()</code> function from pandas:</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>indivinfo <span class="op">=</span> pd.read_stata(<span class="st">"datav4.0/Data/2. Demographics and Outcomes/individual_characteristics.dta"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>indivinfo.drop_duplicates(subset<span class="op">=</span>[<span class="st">"pid"</span>], inplace<span class="op">=</span><span class="va">True</span>) <span class="co">## one individual (6109803) is repeated twice.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="5" type="1">
<li>Ensure that the <code>pid</code> is a string (we will need this later):</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>indivinfo[<span class="st">"pid"</span>] <span class="op">=</span> indivinfo[<span class="st">"pid"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>indivinfo[<span class="st">"hhid"</span>] <span class="op">=</span> indivinfo[<span class="st">"hhid"</span>].astype(<span class="bu">str</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-3-build-an-edge-list-per-village" class="level1">
<h1>Step 3: Build an edge list per village</h1>
<p>We will now build the edge list for each village. We will illustrate the process for village 1, but if you scroll down you will find the full script for all villages.</p>
<section id="read-metadata" class="level2">
<h2 class="anchored" data-anchor-id="read-metadata">3.1. Read metadata</h2>
<p>Let‚Äôs first subset the individual-level metadata to keep only the relevant village:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of where the edgelist files are stored</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    RAW_CSV_FOLDER <span class="op">=</span> <span class="st">"2010-0760_Data/Data/Raw_csv"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's focus on just one village for now</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    selected_village <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Filter the individual-level metadata to keep only the relevant village</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    resp <span class="op">=</span> indivinfo[indivinfo[<span class="st">"village"</span>] <span class="op">==</span> <span class="dv">1</span>].copy()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    resp[<span class="st">"didsurv"</span>] <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="read-village-data" class="level2">
<h2 class="anchored" data-anchor-id="read-village-data">3.2. Read village data</h2>
<p>Now, let‚Äôs read the <code>village_1.csv</code> file and merge it with the individual-level metadata:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>  village_file <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"village</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  indiv <span class="op">=</span> pd.read_csv(village_file, header <span class="op">=</span> <span class="va">None</span>, names<span class="op">=</span>[<span class="st">"hhid"</span>, <span class="st">"ppid"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">## gender (1-Male, 2-Female)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"gender"</span>] <span class="op">=</span> indiv[<span class="st">"gender"</span>].<span class="bu">map</span>({<span class="dv">1</span>: <span class="st">"Male"</span>, <span class="dv">2</span>: <span class="st">"Female"</span>})</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">## pre-process pid to match the format in the individual-level metadata</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"ppid"</span>] <span class="op">=</span> indiv[<span class="st">"ppid"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"hhid"</span>] <span class="op">=</span> indiv[<span class="st">"hhid"</span>].astype(<span class="bu">str</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"pid"</span>] <span class="op">=</span>  indiv.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'</span><span class="sc">{</span>x[<span class="st">"hhid"</span>]<span class="sc">}{</span><span class="dv">0</span> <span class="cf">if</span> <span class="bu">len</span>(x[<span class="st">"ppid"</span>]) <span class="op">!=</span> <span class="dv">2</span> <span class="cf">else</span> <span class="va">None</span><span class="sc">}{</span>x[<span class="st">"ppid"</span>]<span class="sc">}</span><span class="ss">'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">## Select only the relevant columns</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  selected_cols <span class="op">=</span> [<span class="st">"pid"</span>, <span class="st">"resp_status"</span>, <span class="st">"religion"</span>, <span class="st">"caste"</span>, <span class="st">"didsurv"</span>]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  indiv <span class="op">=</span> pd.merge(indiv, resp[selected_cols], on<span class="op">=</span><span class="st">"pid"</span>, how<span class="op">=</span><span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Which produces a dataframe that looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">indiv.head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<colgroup>
<col style="width: 4%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: right;">hhid</th>
<th style="text-align: right;">ppid</th>
<th style="text-align: left;">gender</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">pid</th>
<th style="text-align: left;">resp_status</th>
<th style="text-align: left;">religion</th>
<th style="text-align: left;">caste</th>
<th style="text-align: right;">didsurv</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">1001</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">100101</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1001</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">100102</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1001</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">100103</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1001</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Female</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">100104</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: left;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">1002</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Male</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">100201</td>
<td style="text-align: left;">Head of Household</td>
<td style="text-align: left;">HINDUISM</td>
<td style="text-align: left;">OBC</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</section>
<section id="read-reports-per-relationship-type" class="level2">
<h2 class="anchored" data-anchor-id="read-reports-per-relationship-type">3.3 Read reports per relationship type</h2>
<p>The survey that produced this data collected information on a number of different types of relationships, four of which were ‚Äúdouble sampled‚Äù (i.e., asked about in two ways, who people <strong>go</strong> to for that type of support, and who <strong>comes</strong> to them). Specifically, they asked about borrowing and receiving money, giving and receiving advice, borrowing and lending household items like kerosene and rice, and visiting and receiving guests. These distinct questions are represented in the data files with the following names:</p>
<ul>
<li>borrowmoney,</li>
<li>receivemoney,</li>
<li>helpdecision,</li>
<li>receiveadvice,</li>
<li>keroricego,</li>
<li>keroricecome,</li>
<li>visitgo,</li>
<li>visitcome</li>
</ul>
<p>Each of these relationships is stored in a separate file. For example, the file <code>borrowmoney1.csv</code> contains information on who reported borrowing money from whom in village 1.</p>
<p>We can read each of these files using the <code>pd.read_csv()</code> function. For example:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>filepath_borrowmoney <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"borrowmoney</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>borrowmoney <span class="op">=</span> pd.read_csv(filepath_borrowmoney, header<span class="op">=</span><span class="va">None</span>, na_values<span class="op">=</span>ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The <code>ALL_NA_CODES</code> variable is a vector of all the codes that, after inspection, we identified were used to represent missing values in the data:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ALL_NA_CODES <span class="op">=</span> [<span class="st">"9999999"</span>, <span class="st">"5555555"</span>, <span class="st">"7777777"</span>, <span class="st">"0"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>What the data looks like</strong></p>
<p>The data is stored here as a node list, but it will need to be further pre-processed as an edge list:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
<th style="text-align: right;">5</th>
<th style="text-align: right;">6</th>
<th style="text-align: right;">7</th>
<th style="text-align: right;">8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">100201</td>
<td style="text-align: right;">107603</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">100202</td>
<td style="text-align: right;">100201</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">100601</td>
<td style="text-align: right;">101901</td>
<td style="text-align: right;">102601</td>
<td style="text-align: right;">115501</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">100602</td>
<td style="text-align: right;">100501</td>
<td style="text-align: right;">101902</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">100701</td>
<td style="text-align: right;">100801</td>
<td style="text-align: right;">102101</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">100702</td>
<td style="text-align: right;">100801</td>
<td style="text-align: right;">104001</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
<td style="text-align: right;">nan</td>
</tr>
</tbody>
</table>
<p>Each row represents reports made by a single individual; the first number is the <code>pid</code> (the ‚Äúperson identifier‚Äù) of the individual who reported the relationship, whereas the remaining however many numbers listed in the same row are the <code>pid</code>s of the individuals who were reported to be involved in the relationship.</p>
</section>
<section id="pre-process-the-data-to-build-the-edge-list" class="level2">
<h2 class="anchored" data-anchor-id="pre-process-the-data-to-build-the-edge-list">3.4. Pre-process the data to build the edge list</h2>
<p>We want the network data to be in the following format, plus a few additional columns:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">i</th>
<th style="text-align: right;">j</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">100201</td>
<td style="text-align: right;">107603</td>
</tr>
<tr class="even">
<td style="text-align: right;">100202</td>
<td style="text-align: right;">100201</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100601</td>
<td style="text-align: right;">101901</td>
</tr>
<tr class="even">
<td style="text-align: right;">100601</td>
<td style="text-align: right;">102601</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100601</td>
<td style="text-align: right;">115501</td>
</tr>
<tr class="even">
<td style="text-align: right;">100602</td>
<td style="text-align: right;">100501</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100602</td>
<td style="text-align: right;">101902</td>
</tr>
<tr class="even">
<td style="text-align: right;">100701</td>
<td style="text-align: right;">100801</td>
</tr>
<tr class="odd">
<td style="text-align: right;">100701</td>
<td style="text-align: right;">102101</td>
</tr>
<tr class="even">
<td style="text-align: right;">100702</td>
<td style="text-align: right;">100801</td>
</tr>
</tbody>
</table>
<p>To achieve this, we will need to <a href="https://pandas.pydata.org/docs/user_guide/reshaping.html#pivot-tables">pivot</a> the data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tie_type <span class="op">=</span> <span class="st">"borrowmoney"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Example with the borrowmoney data</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.melt(borrowmoney, id_vars<span class="op">=</span>[<span class="dv">0</span>]).dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This produces a bogus <code>variable</code> column, which we can drop. We should also rename the columns to something more meaningful. It is <strong>important</strong> that we add a <code>respondent</code> column. This will be the <code>pid</code> of the individual who reported the relationship.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns<span class="op">=</span><span class="st">"variable"</span>)<span class="op">\</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"i"</span>, <span class="st">"value"</span>: <span class="st">"j"</span>})<span class="op">\</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       .assign(respondent<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"i"</span>])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's also add a column for the tie type</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(tie_type<span class="op">=</span>tie_type)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's add a weight column too</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(weight<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now, if the question was ‚ÄúDid you borrow money from anyone?‚Äù, then the <code>i</code> column should be the respondent, and the <code>j</code> column should be the person who was reported to have borrowed money from the respondent. However, if the question was ‚ÄúDid anyone borrow money from you?‚Äù, then the <code>i</code> column should be the person who was reported to have borrowed money from the respondent, and the <code>j</code> column should be the respondent. We can use the <code>tie_type</code> variable to determine which of these two scenarios applies.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> tie_type <span class="kw">in</span> [<span class="st">"borrowmoney"</span>, <span class="st">"keroricego"</span>, <span class="st">"visitgo"</span>]:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.rename(columns<span class="op">=</span>{<span class="st">"i"</span>: <span class="st">"j"</span>, <span class="st">"j"</span>: <span class="st">"i"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let‚Äôs reorder the columns to guarantee we can <code>rbind</code> the data frames of all relationship tipes together later.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">"respondent"</span>, <span class="st">"i"</span>, <span class="st">"j"</span>, <span class="st">"tie_type"</span>, <span class="st">"weight"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>which produces the following data frame:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: right;">respondent</th>
<th style="text-align: right;">i</th>
<th style="text-align: right;">j</th>
<th style="text-align: left;">tie_type</th>
<th style="text-align: right;">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">100201</td>
<td style="text-align: right;">107603</td>
<td style="text-align: right;">100201</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">100202</td>
<td style="text-align: right;">100201</td>
<td style="text-align: right;">100202</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">100601</td>
<td style="text-align: right;">101901</td>
<td style="text-align: right;">100601</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">100602</td>
<td style="text-align: right;">100501</td>
<td style="text-align: right;">100602</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">100701</td>
<td style="text-align: right;">100801</td>
<td style="text-align: right;">100701</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">100702</td>
<td style="text-align: right;">100801</td>
<td style="text-align: right;">100702</td>
<td style="text-align: left;">borrowmoney</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
<p><strong>The above is the format we want the data to be in! This format will make it easier to work with <code>VIMuRe</code>.</strong></p>
<p>Use the full pre-processing script below to pre-process all the data for all tie types and save it to a single <code>vil1_edges.csv</code> file. We also save the <code>indiv</code> data frame to a <code>vil1_meta.csv</code> file.</p>
<details>
<summary>
Click to see full pre-processing script
</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># village IDs 13 and 22 are missing</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>VALID_VILLAGE_IDS <span class="op">=</span> [i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">77</span><span class="op">+</span><span class="dv">1</span>) <span class="cf">if</span> i <span class="op">!=</span> <span class="dv">13</span> <span class="kw">and</span> i <span class="op">!=</span> <span class="dv">22</span>] </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># codes for missing values</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>ALL_NA_CODES <span class="op">=</span> [<span class="st">"9999999"</span>, <span class="st">"5555555"</span>, <span class="st">"7777777"</span>, <span class="st">"0"</span>] </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>RAW_CSV_FOLDER <span class="op">=</span> <span class="st">"2010-0760_Data/Data/Raw_csv"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> VALID_VILLAGE_IDS:</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  selected_village <span class="op">=</span> i</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">## Read in the files that include details of each individual and of each sharing unit</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  resp <span class="op">=</span> indivinfo[indivinfo[<span class="st">"village"</span>] <span class="op">==</span> selected_village].copy()</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  resp[<span class="st">"didsurv"</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  village_file <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"village</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  indiv <span class="op">=</span> pd.read_csv(village_file, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  indiv.columns <span class="op">=</span> [<span class="st">"hhid"</span>, <span class="st">"ppid"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"age"</span>] <span class="op">=</span> indiv[<span class="st">"age"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">## gender (1-Male, 2-Female)</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"gender"</span>] <span class="op">=</span> indiv[<span class="st">"gender"</span>].<span class="bu">map</span>({<span class="st">"1"</span>: <span class="st">"Male"</span>, <span class="st">"2"</span>: <span class="st">"Female"</span>})</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  indiv[<span class="st">"pid"</span>] <span class="op">=</span> indiv.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'</span><span class="sc">{</span>x[<span class="st">"hhid"</span>]<span class="sc">}{</span>x[<span class="st">"ppid"</span>]<span class="sc">}</span><span class="ss">'</span> </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">if</span> <span class="bu">len</span>(x[<span class="st">"ppid"</span>]) <span class="op">==</span> <span class="dv">2</span> </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">else</span> <span class="ss">f'</span><span class="sc">{</span>x[<span class="st">"hhid"</span>]<span class="sc">}</span><span class="ss">0</span><span class="sc">{</span>x[<span class="st">"ppid"</span>]<span class="sc">}</span><span class="ss">'</span>,</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>                                        axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">## Select only the relevant columns</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  selected_cols <span class="op">=</span> [<span class="st">"pid"</span>, <span class="st">"resp_status"</span>, <span class="st">"religion"</span>, <span class="st">"caste"</span>, <span class="st">"didsurv"</span>]</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  indiv <span class="op">=</span> pd.merge(indiv, resp[selected_cols], on<span class="op">=</span><span class="st">"pid"</span>)</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">## Read in the files that include details on each relationship</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>  filepath_borrowmoney <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"borrowmoney</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  borrowmoney <span class="op">=</span> pd.read_csv(filepath_borrowmoney, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  filepath_receivemoney <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"lendmoney</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>  receivemoney <span class="op">=</span> pd.read_csv(filepath_receivemoney, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  filepath_giveadvice <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"giveadvice</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  receiveadvice <span class="op">=</span> pd.read_csv(filepath_giveadvice, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  filepath_helpdecision <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"helpdecision</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>  helpdecision <span class="op">=</span> pd.read_csv(filepath_helpdecision, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>  filepath_keroricecome <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"keroricecome</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  keroricecome <span class="op">=</span> pd.read_csv(filepath_keroricecome, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  filepath_keroricego <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"keroricego</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  keroricego <span class="op">=</span> pd.read_csv(filepath_keroricego, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  filepath_visitcome <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"visitcome</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  visitcome <span class="op">=</span> pd.read_csv(filepath_visitcome, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  filepath_visitgo <span class="op">=</span> os.path.join(RAW_CSV_FOLDER, <span class="ss">f"visitgo</span><span class="sc">{</span>selected_village<span class="sc">}</span><span class="ss">.csv"</span>)</span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  visitgo <span class="op">=</span> pd.read_csv(filepath_visitgo, header <span class="op">=</span> <span class="va">None</span>, na_values <span class="op">=</span> ALL_NA_CODES, dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  tietypes <span class="op">&lt;-</span> {<span class="st">"borrowmoney"</span>: borrowmoney,</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a>               <span class="st">"receivemoney"</span>: receivemoney,</span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>               <span class="st">"helpdecision"</span>: helpdecision,</span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>               <span class="st">"receiveadvice"</span>: receiveadvice,</span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>               <span class="st">"keroricego"</span>: keroricego,</span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>               <span class="st">"keroricecome"</span>: keroricecome,</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>               <span class="st">"visitgo"</span>: visitgo,</span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>               <span class="st">"visitcome"</span>: visitcome}</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>  edges <span class="op">=</span> []</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> selected_tie_type, df_tie <span class="kw">in</span> tietypes.items():</span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.melt(df_tie, id_vars<span class="op">=</span>[<span class="dv">0</span>]).dropna()</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop(columns<span class="op">=</span><span class="st">"variable"</span>)<span class="op">\</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>       .rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">"i"</span>, <span class="st">"value"</span>: <span class="st">"j"</span>})<span class="op">\</span></span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>       .assign(respondent<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="st">"i"</span>])</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's also add a column for the tie type</span></span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.assign(tie_type<span class="op">=</span>selected_tie_type)</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's add a weight column too</span></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.assign(weight<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tie_type <span class="kw">in</span> [<span class="st">"borrowmoney"</span>, <span class="st">"keroricego"</span>, <span class="st">"visitgo"</span>]:</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>      df <span class="op">=</span> df.rename(columns<span class="op">=</span>{<span class="st">"i"</span>: <span class="st">"j"</span>, <span class="st">"j"</span>: <span class="st">"i"</span>})</span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df[[<span class="st">"respondent"</span>, <span class="st">"i"</span>, <span class="st">"j"</span>, <span class="st">"tie_type"</span>, <span class="st">"weight"</span>]]</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>    edges.append(df)</span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>  edges <span class="op">=</span> pd.concat(edges)</span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>  edges.to_csv(<span class="ss">f"vil</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">_edges.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>  indiv.to_csv(<span class="ss">f"vil</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">_meta.csv"</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>



</details></section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-banerjee_diffusion_2013-1" class="csl-entry" role="doc-biblioentry">
Banerjee, Abhijit, Arun G. Chandrasekhar, Esther Duflo, and Matthew O. Jackson. 2013a. <span>‚ÄúThe <span>Diffusion</span> of <span>Microfinance</span> (<span>Dataset</span>).‚Äù</span> Harvard Dataverse. <a href="https://doi.org/10.7910/DVN/U3BIHX">https://doi.org/10.7910/DVN/U3BIHX</a>.
</div>
<div id="ref-banerjee_diffusion_2013" class="csl-entry" role="doc-biblioentry">
‚Äî‚Äî‚Äî. 2013b. <span>‚ÄúThe <span>Diffusion</span> of <span>Microfinance</span>.‚Äù</span> <em>Science</em> 341 (6144): 1236498. <a href="https://doi.org/10.1126/science.1236498">https://doi.org/10.1126/science.1236498</a>.
</div>
<div id="ref-de_bacco_latent_2023" class="csl-entry" role="doc-biblioentry">
De Bacco, Caterina, Martina Contisciani, Jonathan Cardoso-Silva, Hadiseh Safdari, Gabriela Lima Borges, Diego Baptista, Tracy Sweet, et al. 2023. <span>‚ÄúLatent Network Models to Account for Noisy, Multiply Reported Social Network Data.‚Äù</span> <em>Journal of the Royal Statistical Society Series A: Statistics in Society</em>, February, qnac004. <a href="https://doi.org/10.1093/jrsssa/qnac004">https://doi.org/10.1093/jrsssa/qnac004</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp(/^(?:http:|https:)\/\/(?:latentnetworks\.github\.io\/|localhost)/);
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->



</body></html>